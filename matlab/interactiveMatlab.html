

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Interactive work on compute nodes &mdash; Introduction to running R, Python, and Julia in HPC 2.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx_lesson.css?v=0c089442" />
      <link rel="stylesheet" type="text/css" href="../_static/term_role_formatting.css?v=4194e21c" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx_rtd_theme_ext_color_contrast.css?v=8e8ea19f" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=a5c4661c" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=60dbed4a"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=6dbb43f8"></script>
      <script src="../_static/minipres.js?v=a0d29692"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script src="../_static/tabs.js?v=3030b3cb"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Local desktop" href="local_desktopMatlab.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Introduction to running R, Python, and Julia in HPC
              <img src="../_static/logo-python-hpc-course.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Pre-requirements:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../prereqs.html">Pre-requirements</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">COMMON:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../common/login.html">Log in session</a></li>
<li class="toctree-l1"><a class="reference internal" href="../common/ondemand-desktop.html">Desktop On-Demand</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python Lessons:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../python/intro.html">Introduction Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/load_runPython.html">Load and run python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/packages.html">Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/isolated.html">Isolated environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/batchPython.html">Running Python in batch mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/GPU.html">Using GPUs with Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/interactivePython.html">Interactive work on the compute nodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/jupyter.html">Jupyter on compute nodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../common/parallel.html">Parallel and multithreaded functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/condaUPPMAX.html">Conda at UPPMAX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/exercisesPython.html">Exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/summaryPython.html">Summary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Julia Lessons:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../julia/introJulia.html">Introduction Julia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../julia/load_runJulia.html">Load and run Julia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../julia/isolatedJulia.html">Packages and isolated environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../julia/batchJulia.html">Running Julia in batch mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../common/parallel.html">Parallel and multithreaded functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../julia/interactiveJulia.html">Interactive work on compute nodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../julia/exercisesJulia.html">Exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../julia/summaryJulia.html">Summary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">R Lessons:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../r/introR.html">Introduction R</a></li>
<li class="toctree-l1"><a class="reference internal" href="../r/load_runR.html">Load and run R</a></li>
<li class="toctree-l1"><a class="reference internal" href="../r/packagesR.html">Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../r/isolatedR.html">Isolated environments with <code class="docutils literal notranslate"><span class="pre">renv</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../r/batchR.html">Running R in batch mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../common/parallel.html">Parallel and multithreaded functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../r/MLR.html">ML with R</a></li>
<li class="toctree-l1"><a class="reference internal" href="../r/interactiveR.html">Interactive work on the compute nodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../r/rstudio.html">Using RStudio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../r/exercisesR.html">Exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../r/summaryR.html">Summary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Matlab Lessons:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introMatlab.html">Introduction to MATLAB</a></li>
<li class="toctree-l1"><a class="reference internal" href="load_runMatlab.html">Load and Run MATLAB</a></li>
<li class="toctree-l1"><a class="reference internal" href="add_onsMatlab.html">Add-Ons</a></li>
<li class="toctree-l1"><a class="reference internal" href="../common/parallel.html">Parallel and multithreaded functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="local_desktopMatlab.html">Local desktop</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Interactive work on compute nodes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#general">General</a></li>
<li class="toctree-l2"><a class="reference internal" href="#matlab-interactively-on-the-compute-nodes">Matlab “interactively” on the compute nodes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#example-code-along">Example <strong>Code along</strong></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#running-a-script">Running a script</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#running-matlab-in-a-jupyter-notebook">Running Matlab in a Jupyter notebook</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Introduction to running R, Python, and Julia in HPC</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Interactive work on compute nodes</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/UPPMAX/R-python-julia-HPC/blob/main/docs/matlab/interactiveMatlab.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="interactive-work-on-compute-nodes">
<h1>Interactive work on compute nodes<a class="headerlink" href="#interactive-work-on-compute-nodes" title="Link to this heading"></a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>It is possible to run Matlab directly on the login (including ThinLinc) nodes.</p></li>
<li><p>But this should <em>only</em> be done for shorter jobs or jobs that do not use a lot of resources, as the login nodes can otherwise become slow for all users.</p></li>
<li><p>If you want to work interactively with your code or data, you should start an interactive session.</p></li>
<li><p>If you rather will run a script which won’t use any interactive user input while running, you can instead start a batch job, see next session.</p></li>
</ul>
</div>
<div class="admonition-questions questions admonition" id="questions-0">
<p class="admonition-title">Questions</p>
<ul class="simple">
<li><p>How to reach the calculation nodes</p></li>
<li><p>How do I proceed to work interactively?</p></li>
</ul>
</div>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Show how to reach the calculation nodes on UPPMAX and HPC2N</p></li>
<li><p>Test some commands on the calculation nodes</p></li>
</ul>
</div>
<div class="admonition-compute-allocations-in-this-workshop admonition">
<p class="admonition-title">Compute allocations in this workshop</p>
<ul class="simple">
<li><p>Rackham: <code class="docutils literal notranslate"><span class="pre">naiss2024-22-107</span></code></p></li>
<li><p>Kebnekaise: <code class="docutils literal notranslate"><span class="pre">hpc2n2024-025</span></code></p></li>
</ul>
</div>
<p>There are several ways to run Matlab interactively</p>
<ul class="simple">
<li><p>Directly on the login nodes: <strong>only</strong> do this for short jobs that do not take a lot of resources</p></li>
<li><p>As an interactive job on the computer nodes, launched via the batch system or Desktop On-Demand (LUNARC)</p></li>
<li><p>Jupyter notebooks (HPC2N, UPPMAX)</p></li>
</ul>
<section id="general">
<h2>General<a class="headerlink" href="#general" title="Link to this heading"></a></h2>
<p>In order to run interactively, you need to have compute nodes allocated to run on, and this is done through the batch system.</p>
<p>Because you will have to wait until the nodes are allocated, and because you cannot know when this happens,
this is not usually a recommended way to run MATLAB, but it is possible.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>(HPC2N) Do note that it is not <em>real</em> interactivity as you probably mean it, as you will have to run it as a
batch script instead of by starting it and giving commands inside it.
- The reason for this is that you are not actually logged into the compute node and only sees the output of the commands you run.</p>
<p>Another option would be to use Jupyter notebooks.</p>
</div>
</section>
<section id="matlab-interactively-on-the-compute-nodes">
<h2>Matlab “interactively” on the compute nodes<a class="headerlink" href="#matlab-interactively-on-the-compute-nodes" title="Link to this heading"></a></h2>
<p>To run interactively, you need to allocate resources on the cluster first.
You can use the command salloc to allow interactive use of resources allocated to your job.
When the resources are allocated, you need to preface commands with <code class="docutils literal notranslate"><span class="pre">srun</span></code> in order to
run on the allocated nodes instead of the login node.</p>
<ul class="simple">
<li><p>First, you make a request for resources with <code class="docutils literal notranslate"><span class="pre">interactive</span></code>/<code class="docutils literal notranslate"><span class="pre">salloc</span></code>, like this:</p></li>
</ul>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-0-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-0-0-0" name="0-0" role="tab" tabindex="0">UPPMAX (interactive)</button><button aria-controls="panel-0-0-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-1" name="0-1" role="tab" tabindex="-1">HPC2N (salloc)</button><button aria-controls="panel-0-0-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-2" name="0-2" role="tab" tabindex="-1">LUNARC (On-Demand Desktop/GfxLauncher)</button></div><div aria-labelledby="tab-0-0-0" class="sphinx-tabs-panel" id="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>interactive<span class="w"> </span>-n<span class="w"> </span>&lt;tasks&gt;<span class="w"> </span>--time<span class="o">=</span>HHH:MM:SS<span class="w"> </span>-A<span class="w"> </span>naiss2024-22-107
</pre></div>
</div>
</div><div aria-labelledby="tab-0-0-1" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-1" name="0-1" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>salloc<span class="w"> </span>-n<span class="w"> </span>&lt;tasks&gt;<span class="w"> </span>--time<span class="o">=</span>HHH:MM:SS<span class="w"> </span>-A<span class="w"> </span>hpc2n2023-110
</pre></div>
</div>
</div><div aria-labelledby="tab-0-0-2" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-2" name="0-2" role="tabpanel" tabindex="0"></div></div>
<dl class="simple">
<dt>where &lt;tasks&gt; is the number of tasks (or cores, for default 1 task per core), time is given in</dt><dd><p>hours, minutes, and seconds (maximum T168 hours), and then you give the id for your project
(<strong>naiss2024-22-107</strong> for this course)</p>
</dd>
<dt>Your request enters the job queue just like any other job, and interactive/salloc will tell you that it is</dt><dd><p>waiting for the requested resources. When salloc tells you that your job has been allocated
resources, you can interactively run programs on those resources with <code class="docutils literal notranslate"><span class="pre">srun</span></code>. The commands
you run with <code class="docutils literal notranslate"><span class="pre">srun</span></code> will then be executed on the resources your job has been allocated.
If you do not preface with <code class="docutils literal notranslate"><span class="pre">srun</span></code> the command is run on the login node!</p>
</dd>
<dt>You can now run MATLAB scripts on the allocated resources directly instead of waiting for</dt><dd><p>your batch job to return a result. This is an advantage if you want to test your Julia
script or perhaps figure out which parameters are best.</p>
</dd>
</dl>
<section id="example-code-along">
<h3>Example <strong>Code along</strong><a class="headerlink" href="#example-code-along" title="Link to this heading"></a></h3>
<div class="admonition-type-along type-along important admonition" id="type-along-0">
<p class="admonition-title">Type-Along</p>
<p><strong>Requesting 4 cores for 10 minutes, then running Julia</strong></p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-1-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-1-1-0" name="1-0" role="tab" tabindex="0">UPPMAX</button><button aria-controls="panel-1-1-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-1-1-1" name="1-1" role="tab" tabindex="-1">HPC2N</button></div><div aria-labelledby="tab-1-1-0" class="sphinx-tabs-panel" id="panel-1-1-0" name="1-0" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">[bjornc@rackham2 ~]$ </span>interactive<span class="w"> </span>-A<span class="w"> </span>naiss2024-22-107<span class="w"> </span>-p<span class="w"> </span>core<span class="w"> </span>-n<span class="w"> </span><span class="m">4</span><span class="w"> </span>-t<span class="w"> </span><span class="m">10</span>:00
<span class="go">You receive the high interactive priority.</span>
<span class="go">There are free cores, so your job is expected to start at once.</span>

<span class="go">Please, use no more than 6.4 GB of RAM.</span>

<span class="go">Waiting for job 29556505 to start...</span>
<span class="go">Starting job now -- you waited for 1 second.</span>

<span class="gp">[bjornc@r483 ~]$ </span>module<span class="w"> </span>load<span class="w"> </span>julia/1.8.5
</pre></div>
</div>
<p>Let us check that we actually run on the compute node:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">[bjornc@r483 ~]$ </span>srun<span class="w"> </span>hostname
<span class="go">r483.uppmax.uu.se</span>
<span class="go">r483.uppmax.uu.se</span>
<span class="go">r483.uppmax.uu.se</span>
<span class="go">r483.uppmax.uu.se</span>
</pre></div>
</div>
<p>We are. Notice that we got a response from all four cores we have allocated.</p>
</div><div aria-labelledby="tab-1-1-1" class="sphinx-tabs-panel" hidden="true" id="panel-1-1-1" name="1-1" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">[~]$ </span>salloc<span class="w"> </span>-n<span class="w"> </span><span class="m">4</span><span class="w"> </span>--time<span class="o">=</span><span class="m">00</span>:30:00<span class="w"> </span>-A<span class="w"> </span>hpc2n2024-025
<span class="go">salloc: Pending job allocation 20174806</span>
<span class="go">salloc: job 20174806 queued and waiting for resources</span>
<span class="go">salloc: job 20174806 has been allocated resources</span>
<span class="go">salloc: Granted job allocation 20174806</span>
<span class="go">salloc: Waiting for resource configuration</span>
<span class="go">salloc: Nodes b-cn0241 are ready for job</span>
<span class="gp">[~]$ </span>module<span class="w"> </span>load<span class="w"> </span>GCC/10.3.0<span class="w"> </span>OpenMPI/4.1.1<span class="w"> </span>julia/1.8.5
<span class="gp">[~]$</span>
</pre></div>
</div>
<p>Let us check that we actually run on the compute node:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">[~]$ </span>srun<span class="w"> </span>hostname
<span class="go">b-cn0241.hpc2n.umu.se</span>
<span class="go">b-cn0241.hpc2n.umu.se</span>
<span class="go">b-cn0241.hpc2n.umu.se</span>
<span class="go">b-cn0241.hpc2n.umu.se</span>
</pre></div>
</div>
<p>We are. Notice that we got a response from all four cores we have allocated.</p>
</div></div>
</div>
<section id="running-a-script">
<h4>Running a script<a class="headerlink" href="#running-a-script" title="Link to this heading"></a></h4>
<dl>
<dt><strong>The script</strong></dt><dd><p>Adding two numbers from user input (serial-sum.jl)</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># This program will add two numbers that are provided by the user</span>

<span class="c"># Get the numbers</span>
<span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parse</span><span class="p">(</span><span class="w"> </span><span class="kt">Int32</span><span class="p">,</span><span class="w"> </span><span class="nb">ARGS</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="p">)</span>
<span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parse</span><span class="p">(</span><span class="w"> </span><span class="kt">Int32</span><span class="p">,</span><span class="w"> </span><span class="nb">ARGS</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="p">)</span>
<span class="c"># Add the two numbers together</span>
<span class="n">summ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span>
<span class="n">println</span><span class="p">(</span><span class="s">&quot;The sum of the two numbers is &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">summ</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Running the script</strong></p>
<ul>
<li><p>Note that the commands are the same for both HPC2N and UPPMAX!</p>
<blockquote>
<div><p>Running a Julia script in the allocation we made further up. Notice that since we asked for 4 cores, the script is run 4 times, since it is a serial script</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">[~]$ </span>srun<span class="w"> </span>julia<span class="w"> </span>serial-sum.jl<span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">4</span>
<span class="go">The sum of the two numbers is: 7</span>
<span class="go">The sum of the two numbers is: 7</span>
<span class="go">The sum of the two numbers is: 7</span>
<span class="go">The sum of the two numbers is: 7</span>
<span class="gp">[~]$</span>
</pre></div>
</div>
<p>Without the <code class="docutils literal notranslate"><span class="pre">srun</span></code> command, Julia won’t understand that it can use several cores. Therefore the program is run only once.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>~<span class="o">]</span>$<span class="w"> </span>julia<span class="w"> </span>serial-sum.jl<span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">4</span>
The<span class="w"> </span>sum<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>two<span class="w"> </span>numbers<span class="w"> </span>is:<span class="w"> </span><span class="m">7</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
<p><strong>Running Julia REPL (UPPMAX/HPC2N)</strong></p>
<ul class="simple">
<li><p>First start Julia using the 4 cores and check if workers are available</p></li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>julia<span class="w"> </span>-p<span class="w"> </span><span class="m">4</span>
</pre></div>
</div>
<div class="highlight-julia-repl notranslate"><div class="highlight"><pre><span></span><span class="gp">julia&gt;</span><span class="w"> </span><span class="n">nworkers</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
<p><strong>Exit</strong></p>
<p>When you have finished using the allocation, either wait for it to end, or close it with <code class="docutils literal notranslate"><span class="pre">exit</span></code></p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-2-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-2-2-0" name="2-0" role="tab" tabindex="0">UPPMAX</button><button aria-controls="panel-2-2-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-2-2-1" name="2-1" role="tab" tabindex="-1">HPC2N</button></div><div aria-labelledby="tab-2-2-0" class="sphinx-tabs-panel" id="panel-2-2-0" name="2-0" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">[bjornc@r483 ~]$ </span><span class="nb">exit</span>

<span class="go">exit</span>
<span class="go">[screen is terminating]</span>
<span class="go">Connection to r483 closed.</span>

<span class="gp">[bjornc@rackham2 ~]$</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-2-1" class="sphinx-tabs-panel" hidden="true" id="panel-2-2-1" name="2-1" role="tabpanel" tabindex="0"><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>~<span class="o">]</span>$<span class="w"> </span><span class="nb">exit</span>
<span class="nb">exit</span>
salloc:<span class="w"> </span>Relinquishing<span class="w"> </span>job<span class="w"> </span>allocation<span class="w"> </span><span class="m">20174806</span>
salloc:<span class="w"> </span>Job<span class="w"> </span>allocation<span class="w"> </span><span class="m">20174806</span><span class="w"> </span>has<span class="w"> </span>been<span class="w"> </span>revoked.
<span class="o">[</span>~<span class="o">]</span>$
</pre></div>
</div>
</div></div>
</section>
</section>
</section>
<section id="running-matlab-in-a-jupyter-notebook">
<h2>Running Matlab in a Jupyter notebook<a class="headerlink" href="#running-matlab-in-a-jupyter-notebook" title="Link to this heading"></a></h2>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-3-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-3-3-0" name="3-0" role="tab" tabindex="0">UPPMAX</button><button aria-controls="panel-3-3-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-3-3-1" name="3-1" role="tab" tabindex="-1">HPC2N</button></div><div aria-labelledby="tab-3-3-0" class="sphinx-tabs-panel" id="panel-3-3-0" name="3-0" role="tabpanel" tabindex="0"><ul class="simple">
<li><p>For more interactiveness you can run</p></li>
</ul>
</div><div aria-labelledby="tab-3-3-1" class="sphinx-tabs-panel" hidden="true" id="panel-3-3-1" name="3-1" role="tabpanel" tabindex="0"><ul class="simple">
<li><p>Like for Python it is possible to run Matlab in a notebook, i.e. in a web interface with possibility of inline
figures and debugging. An easy way to do this is to load <em>Python</em> and <em>Matlab</em> modules. In shell:</p></li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>Load<span class="w"> </span>Matlab
<span class="gp">$ </span>ml<span class="w"> </span>MATLAB/2023a.Update4
<span class="gp"># </span>Load<span class="w"> </span>a<span class="w"> </span>Python<span class="w"> </span>version<span class="w"> </span>compatible<span class="w"> </span>with<span class="w"> </span>Matlab<span class="w"> </span>and<span class="w"> </span>also<span class="w"> </span>CUDA<span class="w"> </span><span class="o">(</span><span class="k">if</span><span class="w"> </span>you<span class="w"> </span>will<span class="w"> </span>run<span class="w"> </span>on<span class="w"> </span>GPUs<span class="o">)</span>
<span class="gp">$ </span>ml<span class="w"> </span>GCCcore/11.3.0<span class="w">  </span>Python/3.10.4<span class="w"> </span>CUDA/11.7.0
<span class="gp"># </span>Create<span class="w"> </span>an<span class="w"> </span>environment<span class="w"> </span>called<span class="w"> </span>matlabenv<span class="w"> </span><span class="o">(</span>you<span class="w"> </span>can<span class="w"> </span>change<span class="w"> </span>this<span class="w"> </span>name<span class="o">)</span>
<span class="gp">$ </span>python<span class="w"> </span>-m<span class="w"> </span>venv<span class="w"> </span>./matlabenv
<span class="gp"># </span>Activate<span class="w"> </span>this<span class="w"> </span>environment
<span class="gp">$ </span><span class="nb">source</span><span class="w"> </span>matlabenv/bin/activate
<span class="gp"># </span>Perform<span class="w"> </span>installations:<span class="w"> </span>upgrade<span class="w"> </span>pip,<span class="w"> </span>and<span class="w"> </span>packages<span class="w"> </span>that<span class="w"> </span>you<span class="w"> </span>will<span class="w"> </span>need
<span class="gp">$ </span>pip<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>pip
<span class="gp">$ </span>pip<span class="w"> </span>install<span class="w"> </span>-U<span class="w"> </span>scikit-learn
<span class="gp"># </span>Install<span class="w"> </span>Jupyterlab
<span class="gp">$ </span>pip<span class="w"> </span>install<span class="w"> </span>jupyterlab
<span class="gp"># </span>Install<span class="w"> </span>the<span class="w"> </span>Matlab<span class="w"> </span>proxy
<span class="go">pip install jupyter-matlab-proxy</span>
</pre></div>
</div>
<p>Fix the project ID in this batch job job.sh and send it to the queue:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1"># Here you should put your own project id</span>
<span class="c1">#SBATCH -A Project_ID</span>
<span class="c1"># This example asks for 1 core</span>
<span class="c1">#SBATCH -n 1</span>
<span class="c1"># Ask for a suitable amount of time. Remember, this is the time the Jupyter notebook will be available! HHH:MM:SS.</span>
<span class="c1">#SBATCH --time=06:20:00</span>
<span class="c1"># If you use the GPU nodes uncomment the following lines</span>
<span class="c1">#SBATCH --gpus=l40s:1</span>

<span class="c1"># Clear the environment from any previously loaded modules</span>
module<span class="w"> </span>purge<span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
<span class="c1"># Load the module environment suitable for the job</span>
ml<span class="w"> </span>MATLAB/2023a.Update4
ml<span class="w"> </span>GCCcore/11.3.0<span class="w">  </span>Python/3.10.4
ml<span class="w"> </span>CUDA/11.7.0

<span class="c1"># Source the environment</span>
<span class="nb">source</span><span class="w"> </span>matlabenv/bin/activate
<span class="c1"># Start JupyterLab</span>
jupyter<span class="w"> </span>lab<span class="w"> </span>--no-browser<span class="w"> </span>--ip<span class="w"> </span><span class="k">$(</span>hostname<span class="k">)</span>
</pre></div>
</div>
<p>Then, in the output file <em>slurm-&lt;jobID&gt;.out</em> file, copy the url that starts with <em>http://b-cn1403.hpc2n.umu.se:8888/lab</em> and
paste it in a Firefox browser on Kebnekaise. When the Jupyter notebook interface starts, you can choose the <strong>MATLAB kernel</strong>
version from the module you loaded. When you try to run a notebook, Matlab will ask for a type of license. Because you are
running this notebook on our HPC center, you can choose the option Existing License and then Start MATLAB.</p>
<div class="admonition-running-julia-in-jupyter-on-compute-nodes-at-hpc2n admonition">
<p class="admonition-title">Running Julia in Jupyter on compute nodes at HPC2N</p>
<ul class="simple">
<li><p>On Kebnekaise, you can run Jupyter notebooks with Matlab kernels by using batch scripts</p></li>
<li><p>Notebook example: <a class="reference external" href="https://github.com/hpc2n/intro-course/blob/master/exercises/JUPYTERNOTEBOOKS/MATLAB/matlab_kernel.ipynb">https://github.com/hpc2n/intro-course/blob/master/exercises/JUPYTERNOTEBOOKS/MATLAB/matlab_kernel.ipynb</a></p></li>
<li><p><a class="reference external" href="https://www.hpc2n.umu.se/resources/software/jupyter-julia">https://www.hpc2n.umu.se/resources/software/jupyter-julia</a></p></li>
</ul>
</div>
</div></div>
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<ul>
<li><p>Start an interactive session on a calculation node by a SLURM allocation</p>
<blockquote>
<div><ul class="simple">
<li><p>At HPC2N: <code class="docutils literal notranslate"><span class="pre">salloc</span></code> …</p></li>
<li><p>At UPPMAX: <code class="docutils literal notranslate"><span class="pre">interactive</span></code> …</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Follow the same procedure as usual by loading the Julia module and possible prerequisites.</p></li>
</ul>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="local_desktopMatlab.html" class="btn btn-neutral float-left" title="Local desktop" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, UPPMAX &amp; HPC2N.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>